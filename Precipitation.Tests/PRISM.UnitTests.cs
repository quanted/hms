using System;
using System.Collections.Generic;
using System.Text;
using Data;
using Xunit;

namespace Precipitation.Tests
{
    public class PRISMUnitTests
    {

        public string inputObject = "{\"Source\":\"prism\",\"DateTimeSpan\":{\"StartDate\":\"2015-01-01T00:00:00\",\"EndDate\":\"2015-12-31T00:00:00\",\"DateTimeFormat\":\"yyyy-MM-dd HH\"},\"Geometry\":{\"Description\":\"EPA Athens Office\",\"Point\":{\"Latitude\":33.925673,\"Longitude\":-83.355723},\"GeometryMetadata\":{\"City\":\"Athens\",\"State\":\"Georgia\",\"Country\":\"United States\"},\"Timezone\":{\"Name\":\"EST\",\"Offset\":-5.0,\"DLS\":false}},\"DataValueFormat\":\"E3\",\"TemporalResolution\":\"default\",\"TimeLocalized\":true,\"Units\":\"default\",\"OutputFormat\":\"json\",\"BaseURL\":[\"http://csip.engr.colostate.edu:8083/csip-climate/m/prism/1.0\"],\"InputTimeSeries\":{}}";
        public string outputObject = "{\"Dataset\":\"Precipitation\",\"DataSource\":\"prism\",\"Metadata\":{\"prism_status\":\"Finished\",\"prism_suid\":\"5a2cc2cd-64f8-11e8-b880-795c8873a957\",\"prism_cloud_node\":\"10.1.104.29\",\"prism_request_ip\":\"73.118.95.127\",\"prism_service_url\":\"http://csip.engr.colostate.edu:8083/csip-climate/m/prism/1.0\",\"prism_tstamp\":\"2018-05-31 11:30:46\",\"prism_cpu_time\":\"20\",\"prism_expiration_date\":\"2018-05-31 11:31:16\",\"prism_start_date\":\"1/1/2015 12:00:00 AM\",\"prism_end_date\":\"12/31/2015 12:00:00 AM\",\"prism_point_longitude\":\"-83.355723\",\"prism_point_latitude\":\"33.925673\",\"prism_unit\":\"mm\"},\"Data\":{\"2015-01-01 00\":[\"0.000E+000\"],\"2015-01-02 00\":[\"1.460E+000\"],\"2015-01-03 00\":[\"1.535E+001\"],\"2015-01-04 00\":[\"1.716E+001\"],\"2015-01-05 00\":[\"1.298E+001\"],\"2015-01-06 00\":[\"0.000E+000\"],\"2015-01-07 00\":[\"0.000E+000\"],\"2015-01-08 00\":[\"0.000E+000\"],\"2015-01-09 00\":[\"0.000E+000\"],\"2015-01-10 00\":[\"0.000E+000\"],\"2015-01-11 00\":[\"0.000E+000\"],\"2015-01-12 00\":[\"3.990E+000\"],\"2015-01-13 00\":[\"1.190E+000\"],\"2015-01-14 00\":[\"1.620E+000\"],\"2015-01-15 00\":[\"0.000E+000\"],\"2015-01-16 00\":[\"2.860E+000\"],\"2015-01-17 00\":[\"0.000E+000\"],\"2015-01-18 00\":[\"0.000E+000\"],\"2015-01-19 00\":[\"0.000E+000\"],\"2015-01-20 00\":[\"0.000E+000\"],\"2015-01-21 00\":[\"0.000E+000\"],\"2015-01-22 00\":[\"0.000E+000\"],\"2015-01-23 00\":[\"7.170E+000\"],\"2015-01-24 00\":[\"1.637E+001\"],\"2015-01-25 00\":[\"0.000E+000\"],\"2015-01-26 00\":[\"1.300E-001\"],\"2015-01-27 00\":[\"0.000E+000\"],\"2015-01-28 00\":[\"0.000E+000\"],\"2015-01-29 00\":[\"0.000E+000\"],\"2015-01-30 00\":[\"0.000E+000\"],\"2015-01-31 00\":[\"0.000E+000\"],\"2015-02-01 00\":[\"0.000E+000\"],\"2015-02-02 00\":[\"1.670E+001\"],\"2015-02-03 00\":[\"0.000E+000\"],\"2015-02-04 00\":[\"0.000E+000\"],\"2015-02-05 00\":[\"0.000E+000\"],\"2015-02-06 00\":[\"0.000E+000\"],\"2015-02-07 00\":[\"0.000E+000\"],\"2015-02-08 00\":[\"0.000E+000\"],\"2015-02-09 00\":[\"4.500E-001\"],\"2015-02-10 00\":[\"1.275E+001\"],\"2015-02-11 00\":[\"0.000E+000\"],\"2015-02-12 00\":[\"0.000E+000\"],\"2015-02-13 00\":[\"0.000E+000\"],\"2015-02-14 00\":[\"0.000E+000\"],\"2015-02-15 00\":[\"0.000E+000\"],\"2015-02-16 00\":[\"0.000E+000\"],\"2015-02-17 00\":[\"3.079E+001\"],\"2015-02-18 00\":[\"0.000E+000\"],\"2015-02-19 00\":[\"0.000E+000\"],\"2015-02-20 00\":[\"0.000E+000\"],\"2015-02-21 00\":[\"0.000E+000\"],\"2015-02-22 00\":[\"1.682E+001\"],\"2015-02-23 00\":[\"1.052E+001\"],\"2015-02-24 00\":[\"1.810E+000\"],\"2015-02-25 00\":[\"2.630E+000\"],\"2015-02-26 00\":[\"1.707E+001\"],\"2015-02-27 00\":[\"0.000E+000\"],\"2015-02-28 00\":[\"0.000E+000\"],\"2015-03-01 00\":[\"2.770E+000\"],\"2015-03-02 00\":[\"6.120E+000\"],\"2015-03-03 00\":[\"0.000E+000\"],\"2015-03-04 00\":[\"5.040E+000\"],\"2015-03-05 00\":[\"6.100E-001\"],\"2015-03-06 00\":[\"3.340E+000\"],\"2015-03-07 00\":[\"0.000E+000\"],\"2015-03-08 00\":[\"0.000E+000\"],\"2015-03-09 00\":[\"0.000E+000\"],\"2015-03-10 00\":[\"0.000E+000\"],\"2015-03-11 00\":[\"0.000E+000\"],\"2015-03-12 00\":[\"3.900E-001\"],\"2015-03-13 00\":[\"7.500E-001\"],\"2015-03-14 00\":[\"1.578E+001\"],\"2015-03-15 00\":[\"6.900E-001\"],\"2015-03-16 00\":[\"0.000E+000\"],\"2015-03-17 00\":[\"0.000E+000\"],\"2015-03-18 00\":[\"0.000E+000\"],\"2015-03-19 00\":[\"8.780E+000\"],\"2015-03-20 00\":[\"1.359E+001\"],\"2015-03-21 00\":[\"0.000E+000\"],\"2015-03-22 00\":[\"2.210E+000\"],\"2015-03-23 00\":[\"1.639E+001\"],\"2015-03-24 00\":[\"0.000E+000\"],\"2015-03-25 00\":[\"0.000E+000\"],\"2015-03-26 00\":[\"6.700E-001\"],\"2015-03-27 00\":[\"0.000E+000\"],\"2015-03-28 00\":[\"0.000E+000\"],\"2015-03-29 00\":[\"0.000E+000\"],\"2015-03-30 00\":[\"4.230E+000\"],\"2015-03-31 00\":[\"1.540E+000\"],\"2015-04-01 00\":[\"2.500E-001\"],\"2015-04-02 00\":[\"0.000E+000\"],\"2015-04-03 00\":[\"3.810E+000\"],\"2015-04-04 00\":[\"5.810E+000\"],\"2015-04-05 00\":[\"0.000E+000\"],\"2015-04-06 00\":[\"0.000E+000\"],\"2015-04-07 00\":[\"1.375E+001\"],\"2015-04-08 00\":[\"0.000E+000\"],\"2015-04-09 00\":[\"0.000E+000\"],\"2015-04-10 00\":[\"0.000E+000\"],\"2015-04-11 00\":[\"8.870E+000\"],\"2015-04-12 00\":[\"0.000E+000\"],\"2015-04-13 00\":[\"8.500E-001\"],\"2015-04-14 00\":[\"4.498E+001\"],\"2015-04-15 00\":[\"2.890E+000\"],\"2015-04-16 00\":[\"3.307E+001\"],\"2015-04-17 00\":[\"1.020E+000\"],\"2015-04-18 00\":[\"2.227E+001\"],\"2015-04-19 00\":[\"7.810E+000\"],\"2015-04-20 00\":[\"3.128E+001\"],\"2015-04-21 00\":[\"3.730E+000\"],\"2015-04-22 00\":[\"0.000E+000\"],\"2015-04-23 00\":[\"0.000E+000\"],\"2015-04-24 00\":[\"0.000E+000\"],\"2015-04-25 00\":[\"6.520E+000\"],\"2015-04-26 00\":[\"7.950E+000\"],\"2015-04-27 00\":[\"0.000E+000\"],\"2015-04-28 00\":[\"0.000E+000\"],\"2015-04-29 00\":[\"8.460E+000\"],\"2015-04-30 00\":[\"1.028E+001\"],\"2015-05-01 00\":[\"0.000E+000\"],\"2015-05-02 00\":[\"0.000E+000\"],\"2015-05-03 00\":[\"0.000E+000\"],\"2015-05-04 00\":[\"0.000E+000\"],\"2015-05-05 00\":[\"0.000E+000\"],\"2015-05-06 00\":[\"0.000E+000\"],\"2015-05-07 00\":[\"0.000E+000\"],\"2015-05-08 00\":[\"0.000E+000\"],\"2015-05-09 00\":[\"0.000E+000\"],\"2015-05-10 00\":[\"0.000E+000\"],\"2015-05-11 00\":[\"0.000E+000\"],\"2015-05-12 00\":[\"0.000E+000\"],\"2015-05-13 00\":[\"0.000E+000\"],\"2015-05-14 00\":[\"0.000E+000\"],\"2015-05-15 00\":[\"0.000E+000\"],\"2015-05-16 00\":[\"0.000E+000\"],\"2015-05-17 00\":[\"0.000E+000\"],\"2015-05-18 00\":[\"0.000E+000\"],\"2015-05-19 00\":[\"3.800E+000\"],\"2015-05-20 00\":[\"0.000E+000\"],\"2015-05-21 00\":[\"6.500E-001\"],\"2015-05-22 00\":[\"0.000E+000\"],\"2015-05-23 00\":[\"0.000E+000\"],\"2015-05-24 00\":[\"0.000E+000\"],\"2015-05-25 00\":[\"0.000E+000\"],\"2015-05-26 00\":[\"3.170E+000\"],\"2015-05-27 00\":[\"1.825E+001\"],\"2015-05-28 00\":[\"2.500E-001\"],\"2015-05-29 00\":[\"3.230E+000\"],\"2015-05-30 00\":[\"0.000E+000\"],\"2015-05-31 00\":[\"0.000E+000\"],\"2015-06-01 00\":[\"8.940E+000\"],\"2015-06-02 00\":[\"5.550E+000\"],\"2015-06-03 00\":[\"2.201E+001\"],\"2015-06-04 00\":[\"1.477E+001\"],\"2015-06-05 00\":[\"0.000E+000\"],\"2015-06-06 00\":[\"0.000E+000\"],\"2015-06-07 00\":[\"0.000E+000\"],\"2015-06-08 00\":[\"0.000E+000\"],\"2015-06-09 00\":[\"2.560E+000\"],\"2015-06-10 00\":[\"1.057E+001\"],\"2015-06-11 00\":[\"0.000E+000\"],\"2015-06-12 00\":[\"2.730E+000\"],\"2015-06-13 00\":[\"3.000E-002\"],\"2015-06-14 00\":[\"0.000E+000\"],\"2015-06-15 00\":[\"0.000E+000\"],\"2015-06-16 00\":[\"5.000E-002\"],\"2015-06-17 00\":[\"0.000E+000\"],\"2015-06-18 00\":[\"0.000E+000\"],\"2015-06-19 00\":[\"4.770E+000\"],\"2015-06-20 00\":[\"0.000E+000\"],\"2015-06-21 00\":[\"7.940E+000\"],\"2015-06-22 00\":[\"0.000E+000\"],\"2015-06-23 00\":[\"0.000E+000\"],\"2015-06-24 00\":[\"0.000E+000\"],\"2015-06-25 00\":[\"3.600E-001\"],\"2015-06-26 00\":[\"0.000E+000\"],\"2015-06-27 00\":[\"0.000E+000\"],\"2015-06-28 00\":[\"1.288E+001\"],\"2015-06-29 00\":[\"0.000E+000\"],\"2015-06-30 00\":[\"0.000E+000\"],\"2015-07-01 00\":[\"2.084E+001\"],\"2015-07-02 00\":[\"8.920E+000\"],\"2015-07-03 00\":[\"3.274E+001\"],\"2015-07-04 00\":[\"3.264E+001\"],\"2015-07-05 00\":[\"5.230E+000\"],\"2015-07-06 00\":[\"0.000E+000\"],\"2015-07-07 00\":[\"0.000E+000\"],\"2015-07-08 00\":[\"0.000E+000\"],\"2015-07-09 00\":[\"0.000E+000\"],\"2015-07-10 00\":[\"0.000E+000\"],\"2015-07-11 00\":[\"0.000E+000\"],\"2015-07-12 00\":[\"0.000E+000\"],\"2015-07-13 00\":[\"4.000E-001\"],\"2015-07-14 00\":[\"0.000E+000\"],\"2015-07-15 00\":[\"2.708E+001\"],\"2015-07-16 00\":[\"0.000E+000\"],\"2015-07-17 00\":[\"0.000E+000\"],\"2015-07-18 00\":[\"0.000E+000\"],\"2015-07-19 00\":[\"0.000E+000\"],\"2015-07-20 00\":[\"0.000E+000\"],\"2015-07-21 00\":[\"2.660E+000\"],\"2015-07-22 00\":[\"6.430E+000\"],\"2015-07-23 00\":[\"0.000E+000\"],\"2015-07-24 00\":[\"9.900E-001\"],\"2015-07-25 00\":[\"0.000E+000\"],\"2015-07-26 00\":[\"0.000E+000\"],\"2015-07-27 00\":[\"0.000E+000\"],\"2015-07-28 00\":[\"0.000E+000\"],\"2015-07-29 00\":[\"0.000E+000\"],\"2015-07-30 00\":[\"0.000E+000\"],\"2015-07-31 00\":[\"0.000E+000\"],\"2015-08-01 00\":[\"0.000E+000\"],\"2015-08-02 00\":[\"5.300E-001\"],\"2015-08-03 00\":[\"0.000E+000\"],\"2015-08-04 00\":[\"0.000E+000\"],\"2015-08-05 00\":[\"0.000E+000\"],\"2015-08-06 00\":[\"0.000E+000\"],\"2015-08-07 00\":[\"1.963E+001\"],\"2015-08-08 00\":[\"0.000E+000\"],\"2015-08-09 00\":[\"0.000E+000\"],\"2015-08-10 00\":[\"0.000E+000\"],\"2015-08-11 00\":[\"5.313E+001\"],\"2015-08-12 00\":[\"8.800E-001\"],\"2015-08-13 00\":[\"0.000E+000\"],\"2015-08-14 00\":[\"0.000E+000\"],\"2015-08-15 00\":[\"0.000E+000\"],\"2015-08-16 00\":[\"0.000E+000\"],\"2015-08-17 00\":[\"5.000E-002\"],\"2015-08-18 00\":[\"4.936E+001\"],\"2015-08-19 00\":[\"1.153E+001\"],\"2015-08-20 00\":[\"2.977E+001\"],\"2015-08-21 00\":[\"5.200E-001\"],\"2015-08-22 00\":[\"4.500E-001\"],\"2015-08-23 00\":[\"5.850E+000\"],\"2015-08-24 00\":[\"1.025E+001\"],\"2015-08-25 00\":[\"0.000E+000\"],\"2015-08-26 00\":[\"0.000E+000\"],\"2015-08-27 00\":[\"0.000E+000\"],\"2015-08-28 00\":[\"0.000E+000\"],\"2015-08-29 00\":[\"0.000E+000\"],\"2015-08-30 00\":[\"0.000E+000\"],\"2015-08-31 00\":[\"1.174E+001\"],\"2015-09-01 00\":[\"0.000E+000\"],\"2015-09-02 00\":[\"0.000E+000\"],\"2015-09-03 00\":[\"0.000E+000\"],\"2015-09-04 00\":[\"0.000E+000\"],\"2015-09-05 00\":[\"1.020E+000\"],\"2015-09-06 00\":[\"4.620E+000\"],\"2015-09-07 00\":[\"0.000E+000\"],\"2015-09-08 00\":[\"0.000E+000\"],\"2015-09-09 00\":[\"1.753E+001\"],\"2015-09-10 00\":[\"2.018E+001\"],\"2015-09-11 00\":[\"1.144E+001\"],\"2015-09-12 00\":[\"0.000E+000\"],\"2015-09-13 00\":[\"0.000E+000\"],\"2015-09-14 00\":[\"0.000E+000\"],\"2015-09-15 00\":[\"0.000E+000\"],\"2015-09-16 00\":[\"0.000E+000\"],\"2015-09-17 00\":[\"0.000E+000\"],\"2015-09-18 00\":[\"0.000E+000\"],\"2015-09-19 00\":[\"0.000E+000\"],\"2015-09-20 00\":[\"0.000E+000\"],\"2015-09-21 00\":[\"0.000E+000\"],\"2015-09-22 00\":[\"4.000E-002\"],\"2015-09-23 00\":[\"0.000E+000\"],\"2015-09-24 00\":[\"0.000E+000\"],\"2015-09-25 00\":[\"3.771E+001\"],\"2015-09-26 00\":[\"5.510E+000\"],\"2015-09-27 00\":[\"2.360E+000\"],\"2015-09-28 00\":[\"5.800E-001\"],\"2015-09-29 00\":[\"6.440E+000\"],\"2015-09-30 00\":[\"6.530E+000\"],\"2015-10-01 00\":[\"1.110E+000\"],\"2015-10-02 00\":[\"1.544E+001\"],\"2015-10-03 00\":[\"1.035E+001\"],\"2015-10-04 00\":[\"5.518E+001\"],\"2015-10-05 00\":[\"3.500E-001\"],\"2015-10-06 00\":[\"3.580E+000\"],\"2015-10-07 00\":[\"0.000E+000\"],\"2015-10-08 00\":[\"0.000E+000\"],\"2015-10-09 00\":[\"0.000E+000\"],\"2015-10-10 00\":[\"1.989E+001\"],\"2015-10-11 00\":[\"1.206E+001\"],\"2015-10-12 00\":[\"0.000E+000\"],\"2015-10-13 00\":[\"4.740E+000\"],\"2015-10-14 00\":[\"0.000E+000\"],\"2015-10-15 00\":[\"0.000E+000\"],\"2015-10-16 00\":[\"0.000E+000\"],\"2015-10-17 00\":[\"0.000E+000\"],\"2015-10-18 00\":[\"0.000E+000\"],\"2015-10-19 00\":[\"0.000E+000\"],\"2015-10-20 00\":[\"0.000E+000\"],\"2015-10-21 00\":[\"0.000E+000\"],\"2015-10-22 00\":[\"0.000E+000\"],\"2015-10-23 00\":[\"0.000E+000\"],\"2015-10-24 00\":[\"0.000E+000\"],\"2015-10-25 00\":[\"0.000E+000\"],\"2015-10-26 00\":[\"2.590E+000\"],\"2015-10-27 00\":[\"1.449E+001\"],\"2015-10-28 00\":[\"9.410E+000\"],\"2015-10-29 00\":[\"2.870E+000\"],\"2015-10-30 00\":[\"0.000E+000\"],\"2015-10-31 00\":[\"0.000E+000\"],\"2015-11-01 00\":[\"1.841E+001\"],\"2015-11-02 00\":[\"4.265E+001\"],\"2015-11-03 00\":[\"2.866E+001\"],\"2015-11-04 00\":[\"1.210E+000\"],\"2015-11-05 00\":[\"1.480E+000\"],\"2015-11-06 00\":[\"8.780E+000\"],\"2015-11-07 00\":[\"2.047E+001\"],\"2015-11-08 00\":[\"2.751E+001\"],\"2015-11-09 00\":[\"3.931E+001\"],\"2015-11-10 00\":[\"4.640E+000\"],\"2015-11-11 00\":[\"0.000E+000\"],\"2015-11-12 00\":[\"0.000E+000\"],\"2015-11-13 00\":[\"0.000E+000\"],\"2015-11-14 00\":[\"0.000E+000\"],\"2015-11-15 00\":[\"0.000E+000\"],\"2015-11-16 00\":[\"0.000E+000\"],\"2015-11-17 00\":[\"0.000E+000\"],\"2015-11-18 00\":[\"4.740E+000\"],\"2015-11-19 00\":[\"4.468E+001\"],\"2015-11-20 00\":[\"0.000E+000\"],\"2015-11-21 00\":[\"0.000E+000\"],\"2015-11-22 00\":[\"0.000E+000\"],\"2015-11-23 00\":[\"0.000E+000\"],\"2015-11-24 00\":[\"0.000E+000\"],\"2015-11-25 00\":[\"0.000E+000\"],\"2015-11-26 00\":[\"0.000E+000\"],\"2015-11-27 00\":[\"0.000E+000\"],\"2015-11-28 00\":[\"0.000E+000\"],\"2015-11-29 00\":[\"0.000E+000\"],\"2015-11-30 00\":[\"0.000E+000\"],\"2015-12-01 00\":[\"0.000E+000\"],\"2015-12-02 00\":[\"1.020E+000\"],\"2015-12-03 00\":[\"6.700E-001\"],\"2015-12-04 00\":[\"0.000E+000\"],\"2015-12-05 00\":[\"0.000E+000\"],\"2015-12-06 00\":[\"0.000E+000\"],\"2015-12-07 00\":[\"0.000E+000\"],\"2015-12-08 00\":[\"0.000E+000\"],\"2015-12-09 00\":[\"0.000E+000\"],\"2015-12-10 00\":[\"0.000E+000\"],\"2015-12-11 00\":[\"0.000E+000\"],\"2015-12-12 00\":[\"0.000E+000\"],\"2015-12-13 00\":[\"0.000E+000\"],\"2015-12-14 00\":[\"9.500E-001\"],\"2015-12-15 00\":[\"2.890E+000\"],\"2015-12-16 00\":[\"0.000E+000\"],\"2015-12-17 00\":[\"4.682E+001\"],\"2015-12-18 00\":[\"1.278E+001\"],\"2015-12-19 00\":[\"0.000E+000\"],\"2015-12-20 00\":[\"0.000E+000\"],\"2015-12-21 00\":[\"0.000E+000\"],\"2015-12-22 00\":[\"5.066E+001\"],\"2015-12-23 00\":[\"4.730E+000\"],\"2015-12-24 00\":[\"4.742E+001\"],\"2015-12-25 00\":[\"3.287E+001\"],\"2015-12-26 00\":[\"6.330E+000\"],\"2015-12-27 00\":[\"2.800E-001\"],\"2015-12-28 00\":[\"3.350E+000\"],\"2015-12-29 00\":[\"3.611E+001\"],\"2015-12-30 00\":[\"9.500E+000\"]}}";

        [Trait("Priority", "1")]
        [Theory]
        [InlineData(1.0, 0.05748)]
        [InlineData(0.0, 0.0)]
        [InlineData(-1.0, -0.05748)]
        [InlineData(0.5, 0.02874)]
        public void UnitConversion(double modifier, double expected)
        {
            Precipitation precip = new Precipitation
            {
                Input = Newtonsoft.Json.JsonConvert.DeserializeObject<TimeSeriesInput>(inputObject),
                Output = Newtonsoft.Json.JsonConvert.DeserializeObject<TimeSeriesOutput>(outputObject)
            };
            string errorMsg = "";
            Dictionary<string, List<string>> convertedData = PRISM.UnitConversion(out errorMsg, modifier, precip.Output, precip.Input);
            Assert.Equal(expected, Convert.ToDouble(convertedData["2015-01-02 00"][0]));
        }

        [Trait("Priority", "1")]
        [Theory]
        [InlineData("2015-01-01 00", 46.95)]
        [InlineData("2015-06-04 00", 27.9)]
        [InlineData("2015-12-24 00", 126.4)]
        public void WeeklyAggregatedSum(string date, double expected)
        {
            Precipitation precip = new Precipitation
            {
                Input = Newtonsoft.Json.JsonConvert.DeserializeObject<TimeSeriesInput>(inputObject),
                Output = Newtonsoft.Json.JsonConvert.DeserializeObject<TimeSeriesOutput>(outputObject)
            };
            string errorMsg = "";
            Dictionary<string, List<string>> weeklyData = PRISM.WeeklyAggregatedSum(out errorMsg, 1.0, precip.Output, precip.Input);
            Assert.Equal(expected, Convert.ToDouble(weeklyData[date][0]));
        }

        [Trait("Priority", "1")]
        [Theory]
        [InlineData("2015-01-01 00", 80.28)]
        [InlineData("2015-06-01 00", 93.16)]
        [InlineData("2015-12-01 00", 246.9)]
        public void MonthlyAggregatedSum(string date, double expected)
        {
            Precipitation precip = new Precipitation
            {
                Input = Newtonsoft.Json.JsonConvert.DeserializeObject<TimeSeriesInput>(inputObject),
                Output = Newtonsoft.Json.JsonConvert.DeserializeObject<TimeSeriesOutput>(outputObject)
            };
            string errorMsg = "";
            Dictionary<string, List<string>> monthlyData = PRISM.MonthlyAggregatedSum(out errorMsg, 1.0, precip.Output, precip.Input);
            Assert.Equal(expected, Convert.ToDouble(monthlyData[date][0]));
        }

    }
}
